import{a as ne}from"./chunk-MX2BR67D.js";import{a as ee,b as A,c as te,e as U}from"./chunk-W4VTQAXI.js";import{a as ie,b as re,c as M,d as oe,e as D,f as T,g as P}from"./chunk-PKG5FSFZ.js";import{b as Z}from"./chunk-I6E5G4JW.js";import{d as K,l as Q,n as E,p as X}from"./chunk-GTNUZGCN.js";import{$b as h,Ab as G,Ca as z,Cb as O,Db as $,Eb as o,Fb as n,Gb as d,Hb as q,Ib as W,Jb as J,Lb as w,Mb as y,Sb as c,Tb as Y,U as B,Ub as g,Wa as a,Y as k,ac as v,ba as p,ca as u,db as _,la as H,ma as V,ub as j,vb as F,wb as R,yb as C,zb as f}from"./chunk-GJZEK5VD.js";var ae=(()=>{class i{constructor(e,t){this.document=e,this.platformId=t,this.documentIsAccessible=X(this.platformId)}static getCookieRegExp(e){let t=e.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+t+"|;\\s*"+t+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(e){try{return decodeURIComponent(e)}catch{return e}}check(e){return this.documentIsAccessible?(e=encodeURIComponent(e),i.getCookieRegExp(e).test(this.document.cookie)):!1}get(e){if(this.check(e)){e=encodeURIComponent(e);let r=i.getCookieRegExp(e).exec(this.document.cookie);return r&&r[1]?i.safeDecodeURIComponent(r[1]):""}else return""}getAll(){if(!this.documentIsAccessible)return{};let e={},t=this.document;return t.cookie&&t.cookie!==""&&t.cookie.split(";").forEach(r=>{let[l,m]=r.split("=");e[i.safeDecodeURIComponent(l.replace(/^ /,""))]=i.safeDecodeURIComponent(m)}),e}set(e,t,r,l,m,S,N,ge){if(!this.documentIsAccessible)return;if(typeof r=="number"||r instanceof Date||l||m||S||N){let L={expires:r,path:l,domain:m,secure:S,sameSite:N||"Lax",partitioned:ge};this.set(e,t,L);return}let b=encodeURIComponent(e)+"="+encodeURIComponent(t)+";",s=r||{};if(s.expires)if(typeof s.expires=="number"){let L=new Date(new Date().getTime()+s.expires*1e3*60*60*24);b+="expires="+L.toUTCString()+";"}else b+="expires="+s.expires.toUTCString()+";";s.path&&(b+="path="+s.path+";"),s.domain&&(b+="domain="+s.domain+";"),s.secure===!1&&s.sameSite==="None"&&(s.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${e} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),s.secure&&(b+="secure;"),s.sameSite||(s.sameSite="Lax"),b+="sameSite="+s.sameSite+";",s.partitioned&&(b+="Partitioned;"),this.document.cookie=b}delete(e,t,r,l,m="Lax"){if(!this.documentIsAccessible)return;let S=new Date("Thu, 01 Jan 1970 00:00:01 GMT");this.set(e,"",{expires:S,path:t,domain:r,secure:l,sameSite:m})}deleteAll(e,t,r,l="Lax"){if(!this.documentIsAccessible)return;let m=this.getAll();for(let S in m)m.hasOwnProperty(S)&&this.delete(S,e,t,r,l)}static{this.\u0275fac=function(t){return new(t||i)(p(K),p(z))}}static{this.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var se=(()=>{class i{constructor(e){this.service=e}get(e){return this.service.get(e)}put(e,t,r){this.service.set(e,t,r)}putE(e,t,r){this.service.set(e,t,r)}remove(e){this.service.delete(e)}removeAll(){this.service.deleteAll()}check(e){return this.service.check(e)}static{this.\u0275fac=function(t){return new(t||i)(p(ae))}}static{this.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ce=(()=>{class i{constructor(e,t,r){this.http=e,this.eCookieService=t,this.config=r}login(e){return this.http.post(`${this.config.BASE_URL}/auth/login`,e).pipe(B(t=>{this.setToken(t.access_token)}))}logout(){this.setToken(void 0)}isAuthenticated(){return!!this.getToken()}getToken(){return this.token||(this.token=this.eCookieService.get("access_token")),this.token}setToken(e){this.token=e,e?this.eCookieService.putE("access_token",e):this.eCookieService.remove("access_token")}static{this.\u0275fac=function(t){return new(t||i)(p(Z),p(se),p(ne))}}static{this.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var le=[{id:1,label:"AI Assistant",icon:"COMMENT",route:"/chat-assistant"}];var pe=(()=>{class i{constructor(e){this.router=e,this.menuItems=le}getMenuItems(){return this.menuItems}navigateTo(e){this.router.navigate([e])}isActiveRoute(e){return e?this.router.isActive(e,{paths:"exact",queryParams:"ignored",fragment:"ignored",matrixParams:"ignored"}):!1}static{this.\u0275fac=function(t){return new(t||i)(p(A))}}static{this.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ue=(()=>{class i{constructor(){this.userService=u(P),this.dialogService=u(T),this.dialogRef=u(ie),this.isLoading=!0}ngOnInit(){this.loadUserProfile()}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}loadUserProfile(){let e=this.userService.currentUser;e?(this.currentUser=e,this.isLoading=!1):this.userSubscription=this.userService.currentUser$.subscribe({next:t=>{t?(this.currentUser=t,this.isLoading=!1):this.handleUserNotFound()},error:t=>{this.handleError(t)}})}handleUserNotFound(){this.isLoading=!1,this.dialogService.error("User Not Found","Unable to retrieve your profile information. Please log in again.").subscribe(()=>{this.dialogRef.close()})}handleError(e){this.isLoading=!1,this.dialogService.error("Error Loading Profile","An error occurred while loading your profile. Please try again later.").subscribe(()=>{this.dialogRef.close()})}close(){this.dialogRef.close()}getRoleDisplayName(){return this.currentUser?.role?this.currentUser.role.replace(/_/g," ").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):"User"}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=_({type:i,selectors:[["app-profile-popup"]],decls:33,vars:13,consts:[[1,"relative","w-full","max-w-lg","mx-auto","bg-white","dark:bg-gray-800","rounded-xl","shadow-lg","overflow-hidden"],[1,"flex","justify-between","items-center","p-4","border-b","border-gray-300","dark:border-gray-700"],[1,"text-xl","font-semibold","text-gray-900","dark:text-gray-100"],[1,"text-xl","text-gray-500","dark:text-gray-300","hover:text-gray-800","dark:hover:text-gray-100",3,"click"],[1,"px-6","py-4"],[1,"flex","flex-col","gap-6"],[1,"flex","items-center","gap-4"],[1,"w-16","h-16","bg-indigo-100","dark:bg-indigo-800","rounded-full","flex","items-center","justify-center"],[1,"text-2xl","text-indigo-600","dark:text-indigo-300"],[1,"text-2xl","font-semibold","text-gray-800","dark:text-gray-100"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"text-sm","text-gray-700","dark:text-gray-300"],[1,"font-medium"],[1,"flex","items-center","gap-2"],[1,"w-2","h-2","rounded-full"],[1,"p-4","border-t","border-gray-300","dark:border-gray-700","flex","justify-end"],[1,"px-6","py-2","bg-primary","dark:bg-primary","text-white","rounded-lg","hover:bg-secondary","dark:hover:bg-secondary","focus:outline-none","focus:ring-2","focus:ring-primary","dark:focus:ring-accent-yellow","transition-colors","duration-200",3,"click"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),c(3," Profile "),n(),o(4,"button",3),w("click",function(){return r.dialogRef.close()}),d(5,"i"),h(6,"icon"),n()(),o(7,"div",4),q(8),o(9,"div",5)(10,"div",6)(11,"div",7)(12,"span",8),c(13),n()(),o(14,"div")(15,"h3",9),c(16),n(),o(17,"p",10),c(18),n()()(),o(19,"div",11)(20,"p",6)(21,"span",12),c(22,"Role: "),n(),c(23),n(),o(24,"p",6)(25,"span",12),c(26,"Status: "),n(),o(27,"span",13),d(28,"span",14),c(29),n()()()(),W(),n(),o(30,"div",15)(31,"button",16),w("click",function(){return r.dialogRef.close()}),c(32," Close "),n()()()),t&2&&(a(5),f(v(6,11,"CANCEL")),a(8),g(" ",r.currentUser.fullName.charAt(0)," "),a(3),g(" ",r.currentUser.fullName," "),a(2),g(" ",r.currentUser.email," "),a(5),g("",r.currentUser.role," "),a(5),C("bg-green-500",r.currentUser.isActive)("bg-red-500",!r.currentUser.isActive),a(),g(" ",r.currentUser.isActive?"Active":"Inactive"," "))},dependencies:[E,M,D],encapsulation:2})}}return i})();var me=(i,x)=>x.id;function ve(i,x){if(i&1&&(o(0,"a",23),d(1,"i",24),h(2,"icon"),o(3,"span"),c(4),n()()),i&2){let e=x.$implicit,t=y(4);C("bg-primary-50",t.isActiveRoute(e.route))("text-primary",t.isActiveRoute(e.route))("dark:bg-dark-bg",t.isActiveRoute(e.route))("dark:text-accent-yellow",t.isActiveRoute(e.route)),R("routerLink",e.route),a(),f(v(2,12,e.icon)),a(3),Y(e.label)}}function xe(i,x){if(i&1&&(o(0,"div",21),O(1,ve,5,14,"a",22,me),n()),i&2){let e=y(2).$implicit;a(),$(e.children)}}function be(i,x){if(i&1){let e=J();o(0,"div",15),w("click",function(){H(e);let r=y().$implicit,l=y();return V(l.toggleExpand(r))}),o(1,"div",9)(2,"div",16),d(3,"i",17),h(4,"icon"),n(),o(5,"span",18),c(6),n(),d(7,"i",19),h(8,"icon"),n()(),j(9,xe,3,0,"div",20)}if(i&2){let e=y().$implicit;F("aria-expanded",e.expanded),a(3),f(v(4,11,e.icon)),a(3),g(" ",e.label," "),a(),f(v(8,13,"CHEVRON_DOWN")),C("transform",e.expanded)("rotate-180",e.expanded),a(2),R("ngIf",e.expanded)}}function ke(i,x){if(i&1&&(o(0,"a",14)(1,"div",9)(2,"div",16),d(3,"i",25),h(4,"icon"),n(),o(5,"span",26),c(6),n()()()),i&2){let e=y().$implicit,t=y();R("routerLink",e.route),F("aria-current",t.isActiveRoute(e.route)?"page":void 0),a(3),f(v(4,31,e.icon)),C("text-primary",t.isActiveRoute(e.route))("dark:text-accent-yellow",t.isActiveRoute(e.route))("text-gray-600",!t.isActiveRoute(e.route))("dark:text-gray-300",!t.isActiveRoute(e.route))("scale-110",t.isActiveRoute(e.route)),a(2),C("max-w-0",!t.isActiveRoute(e.route))("max-w-[160px]",t.isActiveRoute(e.route))("group-hover:max-w-[160px]",!t.isActiveRoute(e.route))("text-primary",t.isActiveRoute(e.route))("dark:text-accent-yellow",t.isActiveRoute(e.route))("opacity-0",!t.isActiveRoute(e.route))("opacity-100",t.isActiveRoute(e.route))("group-hover:opacity-100",!t.isActiveRoute(e.route)),a(),g(" ",e.label," ")}}function ye(i,x){if(i&1&&(o(0,"div",7),j(1,be,10,15)(2,ke,7,33,"a",14),n()),i&2){let e=x.$implicit;a(),G(e.children?1:2)}}var fe=(()=>{class i{constructor(){this.authService=u(ce),this.navigationService=u(pe),this.dialogService=u(T),this.router=u(A),this.dialog=u(re),this.userService=u(P),this.menuItems=this.navigationService.getMenuItems(),this.AppIcons=oe,this.isDarkMode=!1}ngOnInit(){this.initializeUserData(),this.isDarkMode=document.documentElement.classList.contains("dark"),this.applyTheme()}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}initializeUserData(){let e=this.userService.currentUser;e?this.currentUser=e:this.userSubscription=this.userService.currentUser$.subscribe(t=>{t?this.currentUser=t:this.handleUserNotFound()})}handleUserNotFound(){this.dialogService.error("Error","You are not logged in. Please log in to view your profile.").subscribe()}logout(){this.authService.logout(),this.router.navigate(["/login"])}isActiveRoute(e){return this.navigationService.isActiveRoute(e)}toggleExpand(e){this.menuItems.forEach(t=>{t.id!==e.id&&t.expanded&&(t.expanded=!1)}),e.expanded=!e.expanded}toggleTheme(){this.isDarkMode=!this.isDarkMode,this.applyTheme()}applyTheme(){this.isDarkMode?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))}openProfileDialog(){this.dialog.open(ue,{width:"500px",maxWidth:"90vw",disableClose:!0,ariaLabel:"Profile Information",role:"dialog"})}get iconClass(){if(!this.currentUser?.role)return"USER";switch(this.currentUser.role){case"teacher":return"TEACHER";case"student":return"STUDENT";case"staff":return"STAFF";case"supervisor":return"SUPERVISOR";case"superuser":return"SUPERUSER";case"school_management":return"SCHOOL_MANAGEMENT";case"moe":return"MOE";default:return"USER"}}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=_({type:i,selectors:[["app-navbar"]],decls:18,vars:8,consts:[[1,"bg-white","dark:bg-dark-surface","shadow-lg"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","h-20"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","justify-center"],["src","assets/qulogo.png","alt","School AI Logo",1,"h-12","w-auto"],[1,"flex","items-center","space-x-2","md:space-x-4"],[1,"relative","group"],["aria-label","Open profile",1,"flex","items-center","px-3","py-1","rounded-2xl","bg-gray-100","hover:bg-gray-200","dark:bg-dark-bg","dark:hover:bg-dark-surface","transition-colors","duration-200",3,"click"],[1,"flex","items-center"],["aria-hidden","true",1,"text-2xl","transition-all","duration-300","text-gray-700","dark:text-accent-yellow"],["aria-label","Logout",1,"flex","items-center","gap-2","px-4","py-2","rounded-lg","text-gray-700","dark:text-gray-200","bg-gray-100","dark:bg-dark-bg","hover:bg-gray-200","dark:hover:bg-dark-surface","hover:text-gray-600","dark:hover:text-white","transition",3,"click"],["aria-hidden","true",1,"text-xl"],[1,"font-medium","hidden","md:inline"],[1,"flex","items-center","p-2","rounded-lg","transition","hover:bg-gray-50","dark:hover:bg-dark-bg",3,"routerLink"],["role","button","tabindex","0",1,"flex","items-center","p-2","rounded-lg","cursor-pointer","transition","hover:bg-gray-50","dark:hover:bg-dark-bg",3,"click"],[1,"flex","items-center","min-w-[2.5rem]"],["aria-hidden","true",1,"text-2xl","text-gray-600","dark:text-gray-300","transition-all","duration-300","ease-out","group-hover:text-primary","dark:group-hover:text-accent-yellow","group-hover:scale-110"],[1,"pl-1","text-gray-700","dark:text-gray-200","max-w-0","overflow-hidden","transition-all","duration-300","ease-out","group-hover:max-w-[160px]"],["aria-hidden","true",1,"ml-1","text-gray-600","dark:text-gray-300","transition-transform","duration-300"],["class","absolute top-full right-0 mt-2 w-48 bg-white dark:bg-dark-surface rounded-md shadow-lg z-10 transition-all duration-200 origin-top-right","role","menu",4,"ngIf"],["role","menu",1,"absolute","top-full","right-0","mt-2","w-48","bg-white","dark:bg-dark-surface","rounded-md","shadow-lg","z-10","transition-all","duration-200","origin-top-right"],["role","menuitem",1,"flex","items-center","px-4","py-2","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-dark-bg",3,"routerLink","bg-primary-50","text-primary","dark:bg-dark-bg","dark:text-accent-yellow"],["role","menuitem",1,"flex","items-center","px-4","py-2","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-dark-bg",3,"routerLink"],["aria-hidden","true",1,"mr-3"],["aria-hidden","true",1,"text-2xl","transition-all","duration-300","ease-out"],[1,"pl-1","text-gray-700","dark:text-gray-200","overflow-hidden","transition-all","duration-300","ease-in-out","whitespace-nowrap"]],template:function(t,r){t&1&&(o(0,"nav",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),d(5,"img",5),n()(),o(6,"div",6),O(7,ye,3,1,"div",7,me),o(9,"button",8),w("click",function(){return r.openProfileDialog()}),o(10,"div",9),d(11,"i",10),h(12,"icon"),n()(),o(13,"button",11),w("click",function(){return r.logout()}),d(14,"i",12),h(15,"icon"),o(16,"span",13),c(17,"Logout"),n()()()()()()),t&2&&(a(7),$(r.menuItems),a(4),f(v(12,4,r.iconClass)),a(3),f(v(15,6,"LOGOUT")))},dependencies:[U,te,D,E,Q,M],styles:[".dropdown-open[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:scale(1)}.dropdown-open[_ngcontent-%COMP%]{transition:all .2s ease-out}div[ng-reflect-ng-if=false][_ngcontent-%COMP%], .dropdown-menu[_ngcontent-%COMP%]:not(.dropdown-open){opacity:0;visibility:hidden;transform:scale(.95);transition:all .2s ease-out}"]})}}return i})();var Se=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=_({type:i,selectors:[["app-home"]],decls:7,vars:0,consts:[[1,"min-h-screen","flex","flex-col","decorative-pattern","dark:bg-dark-bg"],[1,"h-20","flex-shrink-0"],[1,"flex-1","min-h-0","overflow-hidden","p-6"],[1,"h-full","max-w-7xl","mx-auto","bg-white","dark:bg-dark-surface","rounded-xl","shadow-lg","dark:shadow-gray-900/30","overflow-auto","transition-colors","duration-200"],[1,"p-6","flex","flex-col","h-full","dark:text-gray-200"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div",1),d(2,"app-navbar"),n(),o(3,"div",2)(4,"main",3)(5,"div",4),d(6,"router-outlet"),n()()()())},dependencies:[E,U,ee,fe],encapsulation:2})}}return i})(),st=Se;export{Se as HomeComponent,st as default};
