import{b as L}from"./chunk-N2HGJLKZ.js";import{a as C,b as f,c as M,d as _,e as F,f as E,g as V,h as I,i as N,j as D,k as G}from"./chunk-7KIS5EUS.js";import{a as T}from"./chunk-BBJGFF6W.js";import{a as S}from"./chunk-FXKGETAD.js";import{m as k}from"./chunk-EJSN6NP7.js";import{Ab as v,Gb as i,Ib as w,Qa as a,Xa as x,_ as d,ja as b,ka as h,mb as u,ob as p,rb as m,vb as e,wb as t,xb as c,zb as y}from"./chunk-QEFPM76F.js";function j(r,g){if(r&1&&(e(0,"div",14),i(1),t()),r&2){let l=v();a(),w(" ",l.errorMessage," ")}}function q(r,g){r&1&&(e(0,"span"),i(1,"Sign in"),t())}function U(r,g){r&1&&(e(0,"span"),i(1,"Signing in..."),t())}var J=(()=>{class r{constructor(){this.http=d(S),this.fb=d(N),this.urlService=d(T),this.router=d(L),this.errorMessage="",this.isLoading=!1}ngOnInit(){this.loginForm=this.fb.group({username:["",[f.required]],password:["",[f.required]]})}onSubmit(){if(this.loginForm.invalid){this.errorMessage="Please fill in all fields";return}this.errorMessage="",this.isLoading=!0;let{username:l,password:s}=this.loginForm.value,o=new FormData;o.append("username",l),o.append("password",s),this.http.post(`${this.urlService.URLS.LOGIN}`,o).subscribe({next:n=>{n.access_token?(localStorage.setItem("access_token",n.access_token),this.router.navigate(["/chat-assistant"])):this.errorMessage="Invalid response from server",this.isLoading=!1},error:n=>{console.error("Login error:",n),n.status===401?this.errorMessage="Invalid username or password":n.status===0?this.errorMessage="Unable to connect to server. Please check your connection.":this.errorMessage=n.error?.detail||"An error occurred during login",this.isLoading=!1}})}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275cmp=x({type:r,selectors:[["app-login"]],decls:29,vars:5,consts:[[1,"min-h-screen","decorative-pattern","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8","bg-white","dark:bg-dark-surface","p-8","rounded-lg","shadow-xl","dark:shadow-gray-900/30","relative","z-10"],[1,"text-center"],[1,"flex","justify-center","mb-4"],["viewBox","0 0 24 24","fill","currentColor",1,"h-16","w-16","text-blue-600","dark:text-accent-yellow"],["d","M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z"],[1,"mt-2","text-3xl","font-extrabold","text-gray-900","dark:text-white"],[1,"mt-2","text-sm","text-gray-600","dark:text-gray-300"],[1,"mt-8","space-y-6",3,"ngSubmit","formGroup"],[1,"rounded-md","shadow-sm","-space-y-px"],["for","username",1,"sr-only"],["id","username","formControlName","username","type","text","required","","placeholder","Username",1,"appearance-none","rounded-none","relative","block","w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","placeholder-gray-500","dark:placeholder-gray-400","text-gray-900","dark:text-white","bg-white","dark:bg-dark-surface","rounded-t-md","focus:outline-none","focus:ring-blue-500","dark:focus:ring-accent-yellow","focus:border-blue-500","dark:focus:border-accent-yellow","focus:z-10","sm:text-sm"],["for","password",1,"sr-only"],["id","password","formControlName","password","type","password","required","","placeholder","Password",1,"appearance-none","rounded-none","relative","block","w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","placeholder-gray-500","dark:placeholder-gray-400","text-gray-900","dark:text-white","bg-white","dark:bg-dark-surface","rounded-b-md","focus:outline-none","focus:ring-blue-500","dark:focus:ring-accent-yellow","focus:border-blue-500","dark:focus:border-accent-yellow","focus:z-10","sm:text-sm"],[1,"text-red-500","dark:text-red-400","text-sm","text-center"],[1,"flex","items-center","justify-end"],[1,"text-sm"],["href","#",1,"font-medium","text-blue-600","dark:text-accent-yellow","hover:text-blue-500","dark:hover:text-accent-yellow/80"],["type","submit",1,"group","relative","w-full","flex","justify-center","py-2","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-blue-600","dark:bg-accent-yellow","hover:bg-blue-700","dark:hover:bg-accent-yellow/90","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","dark:focus:ring-accent-yellow","dark:focus:ring-offset-dark-surface","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","duration-200",3,"disabled"]],template:function(s,o){s&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),b(),e(4,"svg",4),c(5,"path",5),t()(),h(),e(6,"h2",6),i(7," School AI "),t(),e(8,"p",7),i(9," Intelligent School Management System "),t()(),e(10,"form",8),y("ngSubmit",function(){return o.onSubmit()}),e(11,"div",9)(12,"div")(13,"label",10),i(14,"Username"),t(),c(15,"input",11),t(),e(16,"div")(17,"label",12),i(18,"Password"),t(),c(19,"input",13),t()(),u(20,j,2,1,"div",14),e(21,"div",15)(22,"div",16)(23,"a",17),i(24," Forgot your password? "),t()()(),e(25,"div")(26,"button",18),u(27,q,2,0,"span")(28,U,2,0,"span"),t()()()()()),s&2&&(a(10),p("formGroup",o.loginForm),a(10),m(o.errorMessage?20:-1),a(6),p("disabled",o.isLoading||o.loginForm.invalid),a(),m(o.isLoading?-1:27),a(),m(o.isLoading?28:-1))},dependencies:[D,F,C,M,_,I,k,G,E,V],encapsulation:2})}}return r})();export{J as LoginComponent};
